# BMP图片查看器使用手册

## 1. 产品概述

BMP图片查看器是一个专为Linux嵌入式设备设计的简单高效的图像浏览工具，支持触摸屏和键盘控制，提供流畅的用户体验。本软件特别适合嵌入式设备、教学演示和单板计算机使用。

## 2. 安装方法

### 2.1 从源代码安装

1. 克隆或下载代码库
2. 编译程序：
   ```bash
   cd bmp_viewer
   make
   ```
3. 安装程序（可选）：
   ```bash
   sudo make install
   ```

### 2.2 直接使用

编译后，可以直接运行bin目录下的可执行文件：
```bash
cd bin
./bmp_viewer
```

## 3. 基本使用

### 3.1 命令行选项

BMP图片查看器支持以下命令行选项：

- `-h, --help`：显示帮助信息
- `-v, --version`：显示版本信息
- `-c, --config <文件路径>`：指定配置文件路径
- `-t, --touch <设备路径>`：指定触摸设备路径
- `-f, --fast`：使用快速显示模式
- `-d, --delay <毫秒>`：设置显示延迟时间
- `-n, --no-touch`：禁用触摸功能

示例：
```bash
# 使用指定配置文件
./bmp_viewer -c myconfig.conf

# 扫描指定目录的图片，使用快速显示模式
./bmp_viewer -f /path/to/images

# 指定触摸设备，设置10毫秒的显示延迟
./bmp_viewer -t /dev/input/event1 -d 10
```

### 3.2 配置文件

程序默认使用当前目录下的`config.conf`作为配置文件。配置文件格式如下：

```
# 显示设置
screen_width=800
screen_height=480
default_refresh_delay=5
use_slow_refresh=1

# 文件设置
max_bmp_files=100
scan_subdirectories=0

# 触摸设置
touch_device=/dev/input/event0
swipe_threshold=100
enable_touch=1

# LCD设置
lcd_device=/dev/fb0
bits_per_pixel=32

# 调试设置
debug_mode=0
verbose_output=1
```

## 4. 使用界面

### 4.1 键盘控制

以下是可用的键盘控制：

- `n/N` 或 `回车`：显示下一张图片
- `p/P`：显示上一张图片
- `+`：增加刷新延迟（显示变慢）
- `-`：减少刷新延迟（显示变快）
- `0-9`：直接设置刷新速度（0最快，9最慢）
- `s/S`：切换显示模式（快速/逐行）
- `r/R`：重新加载当前图片
- `h/H`：显示帮助信息
- `i/I`：显示当前图片信息
- `d/D`：切换调试模式
- `q/Q/ESC`：退出程序

### 4.2 触摸屏控制

以下是可用的触摸屏操作：

- 点击屏幕左侧1/3区域：显示上一张图片
- 点击屏幕右侧1/3区域：显示下一张图片
- 左滑：显示下一张图片
- 右滑：显示上一张图片
- 上下滑：切换显示模式（快速/逐行）

## 5. 显示模式

BMP图片查看器支持两种显示模式：

1. **逐行显示模式**：图片按照行逐行显示，有动画效果，可以调整每行显示的延迟时间。
2. **快速显示模式**：图片直接完整显示，没有动画效果，适合快速浏览。

可以通过键盘的`s/S`键或者触摸屏上下滑动来切换这两种模式。

## 6. 故障排除

### 6.1 无法打开LCD设备

如果出现"打开LCD失败"错误，请检查：
- 是否有足够权限访问/dev/fb0设备
- 系统是否支持framebuffer
- 是否需要加载相关驱动

### 6.2 触摸屏无响应

如果触摸屏不工作，请检查：
- 触摸设备路径是否正确（默认为/dev/input/event0）
- 是否有足够权限访问触摸设备
- 配置文件中是否启用了触摸功能（enable_touch=1）

### 6.3 图片显示问题

如果图片显示不正确，可能是因为：
- 不支持的BMP格式（仅支持24位和32位BMP）
- 图片尺寸过大
- 色深不匹配

### 6.4 开启调试模式

按下`d/D`键可以切换调试模式，在调试模式下会显示更多的信息，有助于排除问题。

## 7. 高级使用

### 7.1 扫描子目录

默认情况下，程序只扫描指定目录下的BMP文件。如果需要扫描子目录，可以在配置文件中设置：
```
scan_subdirectories=1
```

### 7.2 调整性能

对于性能受限的设备，可以考虑：
- 使用快速显示模式（-f选项）
- 减小最大BMP文件数（max_bmp_files）
- 使用较低分辨率的图片

## 8. 联系与支持

如有问题或建议，请联系开发团队。
